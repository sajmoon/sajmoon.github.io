{"version":3,"sources":["webpack:///path---2016-2016-12-04-deploy-to-kubernetes-running-on-google-container-engine-0daf72348dd69d7d7c05.js","webpack:///./.cache/json/2016-2016-12-04-deploy-to-kubernetes-running-on-google-container-engine.json"],"names":["webpackJsonp","533","module","exports","data","site","siteMetadata","title","author","markdownRemark","id","html","frontmatter","date","pathContext","slug"],"mappings":"AAAAA,cAAc,iBAERC,IACA,SAAUC,EAAQC,GCHxBD,EAAAC,SAAkBC,MAAQC,MAAQC,cAAgBC,MAAA,uBAAAC,OAAA,gBAAuDC,gBAAmBC,GAAA,yJAAAC,KAAA,knLAAw9CC,aAAk6IL,MAAA,0DAAAM,KAAA,uBAA+FC,aAAgBC,KAAA","file":"path---2016-2016-12-04-deploy-to-kubernetes-running-on-google-container-engine-0daf72348dd69d7d7c05.js","sourcesContent":["webpackJsonp([94804929006867],{\n\n/***/ 533:\n/***/ (function(module, exports) {\n\n\tmodule.exports = {\"data\":{\"site\":{\"siteMetadata\":{\"title\":\"Tinkering with Code.\",\"author\":\"Simon Ström\"}},\"markdownRemark\":{\"id\":\"/Users/simon/Code/sajmoon.github.io/src/pages/2016-12-04-deploy-to-kubernetes-running-on-google-container-engine.md absPath of file >>> MarkdownRemark\",\"html\":\"<p>We will setup a small cluster of 3 n1-standard-1 instances. They cost around $25 per month. So the cluster will cost you somewhere above $75 a month for the servers.</p>\\n<p>This is just a few notes from the tutorial from <a href=\\\"http://kubernetes.io/docs/hellonode/\\\">kubernetes.io</a>.</p>\\n<h2>Setup needed before we start with the cluster</h2>\\n<ul>\\n<li>Install google cloud sdk</li>\\n</ul>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>brew cask install google-cloud-sdk</code></pre>\\n      </div>\\n<ul>\\n<li>Create a project on google cloud</li>\\n</ul>\\n<p>Go to <a href=\\\"console.cloud.google.com\\\">console.cloud.google.com</a> and set it up. Remember the project id.</p>\\n<ul>\\n<li>\\n<p>Install kubectl</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>gcloud components install kubectl</code></pre>\\n      </div>\\n</li>\\n<li>\\n<p>Have a sample project.</p>\\n</li>\\n</ul>\\n<p>In a <code>server.js</code> file</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>var http = require('http');\\nvar handleRequest = function(request, response) {\\n  console.log('Received request for URL: ' + request.url);\\n  response.writeHead(200);\\n  response.end('Hello World!');\\n};\\nvar www = http.createServer(handleRequest);\\nwww.listen(8080);</code></pre>\\n      </div>\\n<ul>\\n<li>Create a docker file.</li>\\n</ul>\\n<p><code>Dockerfile</code></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>FROM node:4.4\\nEXPOSE 8080\\nCOPY server.js .\\nCMD node server.js</code></pre>\\n      </div>\\n<ul>\\n<li>Build the docker container</li>\\n</ul>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>docker build -t gcr.io/$PROJECT_ID/hello-node:v1 .</code></pre>\\n      </div>\\n<ul>\\n<li>Authenticated for the google api</li>\\n</ul>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>gcloud auth login\\ngcloud config set project PROJECT_ID</code></pre>\\n      </div>\\n<ul>\\n<li>Push the container to the google docker registry</li>\\n</ul>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>gcloud docker -- push gcr.io/$PROJECT_ID/hello-node:v1</code></pre>\\n      </div>\\n<h3>Create a cluster</h3>\\n<ul>\\n<li>Create a cluster</li>\\n</ul>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>gcloud container clusters create hello-world</code></pre>\\n      </div>\\n<p>Fetch configuration needed</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>gcloud container clusters get-credentials hello-world</code></pre>\\n      </div>\\n<p>I had some missing credentials. Had to run this command again:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>gcloud auth application-default login</code></pre>\\n      </div>\\n<ul>\\n<li>Create a pod</li>\\n</ul>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>kubectl run hello-node --image=gcr.io/$PROJECT_ID/hello-node:v1 --port=8080</code></pre>\\n      </div>\\n<p>Allow external traffic to the application</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>kubectl expose deployment hello-node --type=\\\"LoadBalancer\\\"</code></pre>\\n      </div>\\n<p>To find the ip adress run:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>kubectl get services hello-node</code></pre>\\n      </div>\\n<p>You can now see your service running on you kube cluster.</p>\\n<h3>View the setup</h3>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>kubectl get deployments\\nkubectl get pods\\nkubectl logs <POD-NAME>\\nkubectl cluster-info\\nkubectl get events\\nkubectl config view\\nkubectl get services hello-node</code></pre>\\n      </div>\\n<p>Run <code>kubectl cluser-info</code> and you will see a list of all Kubernetes services running. One is the <code>Kubernetes-Dashboard</code>.</p>\\n<p>If you open that url in the browser you will be prompted for a username and password. These can we viewed (in plain text) with:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>gcloud container clusters describe <cluster-name></code></pre>\\n      </div>\\n<p>Somewhere in there you will find a <code>username</code> and <code>password</code>.</p>\\n<h3>Scaling</h3>\\n<p>Scale up? Or scale down? Define how many instance you want to have running and the rest is managed for you.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>kubectl scale deployment hello-node --replicas=4</code></pre>\\n      </div>\\n<h3>Deploy a new version</h3>\\n<p>Modify you application.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>docker build -t gcr.io/$PROJECT_ID/hello-node:v2 .\\ngcloud docker push gcr.io/$PROJECT_ID/hello-node:v2</code></pre>\\n      </div>\\n<p>To run the new version we set which image we want kube to run.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>kubectl set image deployment/hello-node hello-node=gcr.io/$PROJECT_ID/hello-node:v2</code></pre>\\n      </div>\\n<h3>Clean up you cluster</h3>\\n<p>If you did this to test it out you might want to remove your cluster now.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>kubectl delete service,deployment hello-node\\ngcloud container clusters delete hello-world</code></pre>\\n      </div>\\n<p>List all the images you uploaded</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>gsutil ls</code></pre>\\n      </div>\\n<p>Remove them:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>gsutil rm -r gs://artifacts.$PROJECT_ID.appspot.com/</code></pre>\\n      </div>\\n<p>That it.</p>\",\"frontmatter\":{\"title\":\"Deploy to Kubernetes running on Google Container Engine\",\"date\":\"December 04, 2016\"}}},\"pathContext\":{\"slug\":\"/2016-12-04-deploy-to-kubernetes-running-on-google-container-engine/\"}}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// path---2016-2016-12-04-deploy-to-kubernetes-running-on-google-container-engine-0daf72348dd69d7d7c05.js","module.exports = {\"data\":{\"site\":{\"siteMetadata\":{\"title\":\"Tinkering with Code.\",\"author\":\"Simon Ström\"}},\"markdownRemark\":{\"id\":\"/Users/simon/Code/sajmoon.github.io/src/pages/2016-12-04-deploy-to-kubernetes-running-on-google-container-engine.md absPath of file >>> MarkdownRemark\",\"html\":\"<p>We will setup a small cluster of 3 n1-standard-1 instances. They cost around $25 per month. So the cluster will cost you somewhere above $75 a month for the servers.</p>\\n<p>This is just a few notes from the tutorial from <a href=\\\"http://kubernetes.io/docs/hellonode/\\\">kubernetes.io</a>.</p>\\n<h2>Setup needed before we start with the cluster</h2>\\n<ul>\\n<li>Install google cloud sdk</li>\\n</ul>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>brew cask install google-cloud-sdk</code></pre>\\n      </div>\\n<ul>\\n<li>Create a project on google cloud</li>\\n</ul>\\n<p>Go to <a href=\\\"console.cloud.google.com\\\">console.cloud.google.com</a> and set it up. Remember the project id.</p>\\n<ul>\\n<li>\\n<p>Install kubectl</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>gcloud components install kubectl</code></pre>\\n      </div>\\n</li>\\n<li>\\n<p>Have a sample project.</p>\\n</li>\\n</ul>\\n<p>In a <code>server.js</code> file</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>var http = require('http');\\nvar handleRequest = function(request, response) {\\n  console.log('Received request for URL: ' + request.url);\\n  response.writeHead(200);\\n  response.end('Hello World!');\\n};\\nvar www = http.createServer(handleRequest);\\nwww.listen(8080);</code></pre>\\n      </div>\\n<ul>\\n<li>Create a docker file.</li>\\n</ul>\\n<p><code>Dockerfile</code></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>FROM node:4.4\\nEXPOSE 8080\\nCOPY server.js .\\nCMD node server.js</code></pre>\\n      </div>\\n<ul>\\n<li>Build the docker container</li>\\n</ul>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>docker build -t gcr.io/$PROJECT_ID/hello-node:v1 .</code></pre>\\n      </div>\\n<ul>\\n<li>Authenticated for the google api</li>\\n</ul>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>gcloud auth login\\ngcloud config set project PROJECT_ID</code></pre>\\n      </div>\\n<ul>\\n<li>Push the container to the google docker registry</li>\\n</ul>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>gcloud docker -- push gcr.io/$PROJECT_ID/hello-node:v1</code></pre>\\n      </div>\\n<h3>Create a cluster</h3>\\n<ul>\\n<li>Create a cluster</li>\\n</ul>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>gcloud container clusters create hello-world</code></pre>\\n      </div>\\n<p>Fetch configuration needed</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>gcloud container clusters get-credentials hello-world</code></pre>\\n      </div>\\n<p>I had some missing credentials. Had to run this command again:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>gcloud auth application-default login</code></pre>\\n      </div>\\n<ul>\\n<li>Create a pod</li>\\n</ul>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>kubectl run hello-node --image=gcr.io/$PROJECT_ID/hello-node:v1 --port=8080</code></pre>\\n      </div>\\n<p>Allow external traffic to the application</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>kubectl expose deployment hello-node --type=\\\"LoadBalancer\\\"</code></pre>\\n      </div>\\n<p>To find the ip adress run:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>kubectl get services hello-node</code></pre>\\n      </div>\\n<p>You can now see your service running on you kube cluster.</p>\\n<h3>View the setup</h3>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>kubectl get deployments\\nkubectl get pods\\nkubectl logs <POD-NAME>\\nkubectl cluster-info\\nkubectl get events\\nkubectl config view\\nkubectl get services hello-node</code></pre>\\n      </div>\\n<p>Run <code>kubectl cluser-info</code> and you will see a list of all Kubernetes services running. One is the <code>Kubernetes-Dashboard</code>.</p>\\n<p>If you open that url in the browser you will be prompted for a username and password. These can we viewed (in plain text) with:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>gcloud container clusters describe <cluster-name></code></pre>\\n      </div>\\n<p>Somewhere in there you will find a <code>username</code> and <code>password</code>.</p>\\n<h3>Scaling</h3>\\n<p>Scale up? Or scale down? Define how many instance you want to have running and the rest is managed for you.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>kubectl scale deployment hello-node --replicas=4</code></pre>\\n      </div>\\n<h3>Deploy a new version</h3>\\n<p>Modify you application.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>docker build -t gcr.io/$PROJECT_ID/hello-node:v2 .\\ngcloud docker push gcr.io/$PROJECT_ID/hello-node:v2</code></pre>\\n      </div>\\n<p>To run the new version we set which image we want kube to run.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>kubectl set image deployment/hello-node hello-node=gcr.io/$PROJECT_ID/hello-node:v2</code></pre>\\n      </div>\\n<h3>Clean up you cluster</h3>\\n<p>If you did this to test it out you might want to remove your cluster now.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>kubectl delete service,deployment hello-node\\ngcloud container clusters delete hello-world</code></pre>\\n      </div>\\n<p>List all the images you uploaded</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>gsutil ls</code></pre>\\n      </div>\\n<p>Remove them:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-none\\\"><code>gsutil rm -r gs://artifacts.$PROJECT_ID.appspot.com/</code></pre>\\n      </div>\\n<p>That it.</p>\",\"frontmatter\":{\"title\":\"Deploy to Kubernetes running on Google Container Engine\",\"date\":\"December 04, 2016\"}}},\"pathContext\":{\"slug\":\"/2016-12-04-deploy-to-kubernetes-running-on-google-container-engine/\"}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/json-loader!./.cache/json/2016-2016-12-04-deploy-to-kubernetes-running-on-google-container-engine.json\n// module id = 533\n// module chunks = 94804929006867"],"sourceRoot":""}